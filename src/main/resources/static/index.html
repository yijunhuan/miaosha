<!DOCTYPE html>
<html>

<head>
<meta http-equiv="Content-Type" charset="UTF-8" content="text/html" />
<title>登录</title>

<!--引入jquery文件  -->
<script type="text/javascript" src="js/jquery.js"></script>
<!--引入bootstrap  -->
<link rel="stylesheet" type="text/css"
	href="bootstrap/css/bootstrap.min.css" />
<script type="text/javascript" src="bootstrap/js/bootstrap.min.js"></script>
<!-- jquery-validator -->
<script type="text/javascript"
	src="jquery-validation/jquery.validate.min.js"></script>
<script type="text/javascript"
	src="jquery-validation/localization/messages_zh.min.js"></script>
<!-- layer -->
<script type="text/javascript" src="layer/layer.js"></script>
<!-- md5.js -->
<script type="text/javascript" src="js/md5.min.js"></script>
<!-- common.js -->
<script type="text/javascript" src="js/common.js"></script>

<style type="text/css">
body {
	background: url(img/amazing-sky.jpg);
	color: black;
	margin-top: 160px;
	margin-left: 250px;
}
</style>

</head>

<body>
	<div class="container">

		<div class="row ">
			<form id="loginForm" name="loginForm" method="post"
				class="form-horizontal">
				<div class="row">
					<div class="col-md-3 col-md-push-2">
						<legend>
							<h2 style="text-align: center;">用户登录</h2>
						</legend>
					</div>
				</div>

				<div class="form-group">
					<div class="row">
						<div class="col-md-3 col-md-push-2">
							<input id="mobile" name="mobile" class="form-control" type="text"
								placeholder="请输入手机号" required="true" />
						</div>
					</div>
				</div>

				<div class="form-group ">
					<div class="row">
						<div class="col-md-3 col-md-push-2">
							<input id="password" name="password" class="form-control"
								type="text" placeholder="密码" required="true" />
						</div>
					</div>
				</div>

				<div class="row ">
					<div class="col-md-6 col-md-push-2">
						<div class="col-md-3">
							<button class="btn btn-primary " data-toggle="modal"
								data-target="#modal_login">注册</button>
						</div>
						<div class="col-md-2">
							<button class="btn btn-primary btn-block" id="login_btn"
								onclick="login()">登录</button>
						</div>
					</div>

				</div>

			</form>

			<!-- 注册模态框-->
			<div class="modal fade" tabindex="-1" role="dialog" id="modal_login"
				aria-labelledby="myModallabel">
				<div class="modal-dialog" role="document">
					<div class="modal-content">
						<div class="modal-header">
							<h4 class="modal-title" id="myModallabel">用户注册</h4>
						</div>
						<div class="modal-body">

							<form class="form-horizontal">
								<div class="row form-group">
									<label for="id" class="col-md-2 control-label">手机号：</label>
									<div class="col-md-6">
										<input type="text" class="form-control" name="id"
											placeholder="请输入手机号" />
									</div>
									<span></span>
								</div>

								<div class="row form-group">
									<label for="name" class="col-md-2  control-label">用户名：</label>
									<div class="col-md-6">
										<input type="text" class="form-control" name="name"
											placeholder="请输入用户名" />
									</div>
									<span></span>
								</div>

								<div class="row form-group">
									<label for="password" class="col-md-2 control-label">密
										码：</label>
									<div class="col-md-6">
										<input type="text" class="form-control" name="password"
											placeholder="请输入密码" />
									</div>
									<span></span>
								</div>

								<div class="row form-group">
									<label for="sex" class="col-md-2 control-label">性别：</label>
									<div class="radio-inline">
										<input type="radio" name="sex" value="male" checked="checked" />男
									</div>
									<div class="radio-inline">
										<input type="radio" name="sex" value="famale" />女
									</div>
									<span></span>
								</div>

								<div class="row form-group">
									<label for="email" class="col-md-2 control-label">邮 箱：</label>
									<div class="col-md-6">
										<input type="email" class="form-control" name="email"
											placeholder="@qq.com" />
									</div>
									<span></span>
								</div>

							</form>
						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-default"
								data-dismiss="modal">关闭</button>
							<button type="button" class="btn btn-primary">保存</button>
						</div>
					</div>
					<!-- /.modal-content -->
				</div>
				<!-- /.modal-dialog -->
			</div>
		</div>
	</div>

	<script>
		function login() {
			$("#loginForm").validate({
				submitHandler : function(form) {
					doLogin();
				}
			});
		}

		function doLogin() {
			var inputPass = $("#password").val();
			var salt = g_passsword_salt;
			var str = "" + salt.charAt(0) + salt.charAt(2) + inputPass
					+ salt.charAt(5) + salt.charAt(4);
			var password = md5(str);
			$.ajax({
				url : "/login/do_login",
				type : "POST",
				data : {
					mobile : $("#mobile").val(),
					password : password
				},
				success : function(data) {
					console.log(data);
					if (data.code == 0) {
						layer.msg("成功");
						window.location.href = "/goods/to_list";
					} else {
						layer.msg(data.msg);
					}
				},
				error : function() {
					console.log(data);
					alert("错误调用");
				}
			});
		}
	</script>

</body>

</html>